> [!IMPORTANT]
> このREADMEは生成AIによって作成後、微修正を加えたものです。

# micro-gopush

`micro-gopush`は、軽量なGoベースのWebプッシュ通知サーバーです。VAPIDキーの生成、クライアントの購読管理、および購読しているすべてのクライアントへのプッシュ通知の送信を処理します。このプロジェクトは、Webプッシュ通知をアプリケーションに実装するためのバックエンドソリューションを提供します。

## コンセプト

`micro-gopush`の核となるアイデアは、Webプッシュ通知を管理するためのシンプルで自己完結型のサービスを提供することです。VAPIDキー管理とWebプッシュプロトコルの複雑さを抽象化し、開発者がプッシュ通知機能をWebアプリケーションに簡単に統合できるようにします。

## 機能

*   **VAPIDキーの自動生成**: 起動時にVAPID（Voluntary Application Server Identification）キーを生成し、プッシュサービスとの安全な通信を可能にします。
*   **購読管理**: クライアントがプッシュ通知を購読するためのAPIエンドポイントを提供します。購読情報はメモリ内に保存されます。
*   **ブロードキャスト通知**: 現在購読しているすべてのクライアントにカスタムペイロードを送信するためのAPIエンドポイント。
*   **シンプルなHTTP API**: 相互作用のための直接的なRESTful APIを公開します。

## はじめに

このアプリケーションをローカルで実行するには：

1.  **リポジトリをクローンします:**
    ```bash
    git clone https://github.com/k-wa-wa/micro-gopush.git
    cd micro-gopush
    ```
2.  **アプリケーションを実行します:**
    ```bash
    go run main.go
    ```
    サーバーは`http://localhost:8080`で起動します。クライアント側の実装で必要となるVAPID公開鍵がコンソールに表示されます。

## APIエンドポイント

サーバーは以下のエンドポイントを公開しています：

*   **`GET /vapid-public-key`**:
    *   クライアントがプッシュ通知を購読するために必要なVAPID公開鍵を返します。
    *   レスポンス: `{"publicKey": "YOUR_VAPID_PUBLIC_KEY"}`

*   **`POST /subscribe`**:
    *   クライアントがプッシュ通知を購読できるようにします。リクエストボディには、クライアント側からの`Subscription`オブジェクトを含める必要があります。
    *   リクエストボディの例:
        ```json
        {
          "subscription": {
            "endpoint": "...",
            "expirationTime": null,
            "keys": {
              "p256dh": "...",
              "auth": "..."
            }
          }
        }
        ```
    *   レスポンス: `200 OK`

*   **`POST /notify-all`**:
    *   現在購読しているすべてのクライアントにプッシュ通知を送信します。リクエストボディには、送信するメッセージを含む`message`フィールドを含める必要があります。
    *   リクエストボディの例:
        ```json
        {
          "message": "あなたのカスタム通知メッセージはこちら！"
        }
        ```
    *   サーバーは、プッシュ通知の送信結果（HTTPステータスコード）を確認し、エラーが発生した場合はログに記録します。
    *   レスポンス: `200 OK`
